---
import Counter from '../components/Counter.tsx'
import BaseLayout from '../layouts/BaseLayout.astro'
---

<BaseLayout title="Astro Accepts React and Tailwind!">
  <main class="border">
    <h1 class="text-2xl font-bold">Hello Astro Islands v4</h1></div>
    <div><a href="/layout01/" class="">/layout01</a></div>
    <div><a href="/layout02/" class="">/layout02</a></div>
    <div><a href="/tutorial01/hello" class="">/tutorial01</a></div>
    <div><a href="/tutorial01/hello2" class="">/tutorial02</a></div>
    <div><a href="/example01/" class="">/parallax</a></div>
    <div><a href="/tour/t01/" class="">/tour/01</a></div>
    <div><a href="/tour/t02/" class="">/tour/02</a></div>
    <div><a href="/tour/t03/" class="">/tour/03</a></div>
    <div><a href="/tour/t01-sample/" class="">/tour/t01-sample</a></div>
    <div><a href="/tour/t02-sample/" class="">/tour/t02-sample</a></div>
    <div><a href="/tour/t03-sample/" class="">/tour/t03-sample</a></div>
    <div><a href="/tour/t04-sample/" class="">/tour/t04-sample</a></div>
    <div><a href="/tour/t05-sample/" class="">/tour/t05-sample</a></div>
    <div><a href="/tour/t06-sample/" class="">/tour/t06-sample</a></div>
    <div><a href="/tour/t07-sample/" class="">/tour/t07-sample</a></div>
    <div><a href="/tour/t08-sample/" class="">/tour/t08-sample</a></div>
    <div><a href="/tour/t09-sample/" class="">/tour/t09-sample</a></div>
    <div><a href="/tour/t19-sample/" class="">/tour/t10-sample</a></div>
    <div><a href="/tour/t11-sample/" class="">/tour/t11-sample</a></div>
    <div><a href="/tour/t12-sample/" class="">/tour/t12-sample</a></div>
    
    <br></br>
    <Counter client:visible />
      <button id="btn-hello" class="rounded border px-3 py-2">/api/hello</button>
      <button id="btn-me" class="rounded border px-3 py-2">/api/me</button>

    <pre id="out" class="rounded bg-white p-3 text-sm shadow"></pre>

    <script>
      import { baseAddress } from "../config"

      const out = document.getElementById('out')
      const show = (title: string, data: unknown) => out!.textContent = `${title}\n` + JSON.stringify(data, null, 2)

      document.getElementById('btn-hello')?.addEventListener('click', async () => {
        console.log(`call ${baseAddress}/api/hello`); 
        const r = await fetch(`${baseAddress}/api/hello`, { headers: { Accept: 'application/json' } })
        show('[GET] /api/hello', await r.json())
      })
      document.getElementById('btn-me')?.addEventListener('click', async () => {
        console.log(`call ${baseAddress}/api/me`); 
        const r = await fetch(`${baseAddress}/api/me`, { credentials: 'include' })
        let body; try { body = await r.json() } catch { body = { error: true } }
        show(`[GET] /api/me (${r.status})`, body)
      })
    </script>
  </main>
</BaseLayout>

